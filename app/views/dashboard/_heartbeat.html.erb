<script type="text/javascript"><!--
'use strict';
$(() => {

  const version = '<%= @group.schema.version %>';
  const id = '<%= @group.id %>';
  const minuteColumns = $('#minute-columns-checkbox');
  const autoRefresh   = $('#auto-refresh-checkbox');

  const isChecked = (checkbox) => checkbox.is(':checked');

  const dashboardHeartbeat = () => {
    if (isChecked(autoRefresh)) {
      $.ajax({
        url: '/dashboard/heartbeat',
        data: {
          version: version,
          id: id,
          minute_columns: isChecked(minuteColumns),
          auto_refresh: isChecked(autoRefresh)
        },
        dataType: 'script'
      });
    }
  };

  const milliSecond = 1;
  const seconds = 1000 * milliSecond;
  setInterval(dashboardHeartbeat, 10*seconds);

});
//--></script>
